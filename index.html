<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executar Diagnóstico</title>
</head>
<body>
    <h2>Executar Diagnóstico de Rede</h2>
    <button onclick="executarDiagnostico()">Iniciar Coleta</button>
    <p id="resultado"></p>

    <script>
        function executarDiagnostico() {
            // Caminho do executável local (ajuste conforme necessário)
            var caminhoExecutavel = "C:\\temp\\coleta.exe";

            // Verifica se está rodando localmente (não funciona na web por segurança)
            if (window.location.protocol === "file:") {
                try {
                    const shell = new ActiveXObject("WScript.Shell");
                    shell.Run('"' + caminhoExecutavel + '"', 1, true);
                    document.getElementById("resultado").innerText = "Diagnóstico executado com sucesso!";
                } catch (e) {
                    document.getElementById("resultado").innerText = "Erro ao executar o diagnóstico.";
                }
            } else {
                document.getElementById("resultado").innerText = "Este comando só pode ser executado localmente.";
            }
        }
    </script>
</body>
</html>
